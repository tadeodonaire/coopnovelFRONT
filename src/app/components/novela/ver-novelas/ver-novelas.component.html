<div class="filtro-container">
  <input
    type="text"
    [(ngModel)]="nombreNovelaFiltro"
    placeholder="Filtrar por nombre de novela"
    class="input-filtro"
  />
  <button mat-raised-button color="primary" (click)="filtrarNovelas()">Filtrar</button>
  
  
  <button mat-raised-button color="warn" (click)="restablecerFiltro()" *ngIf="nombreNovelaFiltro">
    Restablecer Filtro
  </button>
</div>


<div *ngIf="novelasFiltradas.length === 0 && nombreNovelaFiltro" class="no-resultados">
  <p>No existe la novela que buscabas, lo siento!</p>
</div>

<div *ngFor="let novela of novelasFiltradas" class="novela-card">
  <h2>{{ novela.name }}</h2>

  
  <div class="genero-badge">{{ novela.genero }}</div>

  
  <p><strong>Autor:</strong> {{ novela.autor }}</p>


  <p><strong>Resumen:</strong></p>
  <p class="resumen-texto">{{ novela.resumen }}</p>

  
  <div *ngFor="let cap of novela.children" class="capitulo-card">
    <div class="capitulo-header">
      <button mat-mini-fab color="primary" (click)="toggleCapitulo(cap.name)">
        <mat-icon>
          {{ isCapituloExpanded(cap.name) ? 'expand_more' : 'chevron_right' }}
        </mat-icon>
      </button>
      <strong class="capitulo-nombre">{{ cap.name }}</strong>
    </div>
    <div class="capitulo-contenido" *ngIf="isCapituloExpanded(cap.name)">
      <p>{{ cap.contenido }}</p>
    </div>
  </div>


  <div class="agregar-biblioteca">
    <select
      id="select-{{ novela.name }}"
      [(ngModel)]="selectedBibliotecas[novela.name]"
      class="custom-select"
    >
      <option value="" disabled selected>Selecciona una biblioteca</option>
      <option *ngFor="let b of misBibliotecas" [value]="b.idBiblioteca">
        {{ b.bibNombre }}
      </option>
    </select>

    <button
      mat-raised-button
      color="accent"
      [disabled]="!selectedBibliotecas[novela.name]"
      (click)="agregarNovelaABiblioteca(novela.name)"
    >
      âž• Agregar a Biblioteca
    </button>
  </div>
</div>
